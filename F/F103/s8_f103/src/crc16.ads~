with HAL;             use HAL;
package CRC16 is

   --  ported from:
   --  https://os.mbed.com/users/EmLa/code/CRC16
   function CalculateCRC16 (Input : UInt8_Array) return UInt16;

private

   CRC16Table : constant UInt16_Array := (
        16#0000#, 16#8005#, 16#800F#, 16#000A#, 16#801B#, 16#001E#, 16#0014#, 16#8011#,
        16#8033#, 16#0036#, 16#003C#, 16#8039#, 16#0028#, 16#802D#, 16#8027#, 16#0022#,
        16#8063#, 16#0066#, 16#006C#, 16#8069#, 16#0078#, 16#807D#, 16#8077#, 16#0072#,
        16#0050#, 16#8055#, 16#805F#, 16#005A#, 16#804B#, 16#004E#, 16#0044#, 16#8041#,
        16#80C3#, 16#00C6#, 16#00CC#, 16#80C9#, 16#00D8#, 16#80DD#, 16#80D7#, 16#00D2#,
        16#00F0#, 16#80F5#, 16#80FF#, 16#00FA#, 16#80EB#, 16#00EE#, 16#00E4#, 16#80E1#,
        16#00A0#, 16#80A5#, 16#80AF#, 16#00AA#, 16#80BB#, 16#00BE#, 16#00B4#, 16#80B1#,
        16#8093#, 16#0096#, 16#009C#, 16#8099#, 16#0088#, 16#808D#, 16#8087#, 16#0082#,
        16#8183#, 16#0186#, 16#018C#, 16#8189#, 16#0198#, 16#819D#, 16#8197#, 16#0192#,
        16#01B0#, 16#81B5#, 16#81BF#, 16#01BA#, 16#81AB#, 16#01AE#, 16#01A4#, 16#81A1#,
        16#01E0#, 16#81E5#, 16#81EF#, 16#01EA#, 16#81FB#, 16#01FE#, 16#01F4#, 16#81F1#,
        16#81D3#, 16#01D6#, 16#01DC#, 16#81D9#, 16#01C8#, 16#81CD#, 16#81C7#, 16#01C2#,
        16#0140#, 16#8145#, 16#814F#, 16#014A#, 16#815B#, 16#015E#, 16#0154#, 16#8151#,
        16#8173#, 16#0176#, 16#017C#, 16#8179#, 16#0168#, 16#816D#, 16#8167#, 16#0162#,
        16#8123#, 16#0126#, 16#012C#, 16#8129#, 16#0138#, 16#813D#, 16#8137#, 16#0132#,
        16#0110#, 16#8115#, 16#811F#, 16#011A#, 16#810B#, 16#010E#, 16#0104#, 16#8101#,
        16#8303#, 16#0306#, 16#030C#, 16#8309#, 16#0318#, 16#831D#, 16#8317#, 16#0312#,
        16#0330#, 16#8335#, 16#833F#, 16#033A#, 16#832B#, 16#032E#, 16#0324#, 16#8321#,
        16#0360#, 16#8365#, 16#836F#, 16#036A#, 16#837B#, 16#037E#, 16#0374#, 16#8371#,
        16#8353#, 16#0356#, 16#035C#, 16#8359#, 16#0348#, 16#834D#, 16#8347#, 16#0342#,
        16#03C0#, 16#83C5#, 16#83CF#, 16#03CA#, 16#83DB#, 16#03DE#, 16#03D4#, 16#83D1#,
        16#83F3#, 16#03F6#, 16#03FC#, 16#83F9#, 16#03E8#, 16#83ED#, 16#83E7#, 16#03E2#,
        16#83A3#, 16#03A6#, 16#03AC#, 16#83A9#, 16#03B8#, 16#83BD#, 16#83B7#, 16#03B2#,
        16#0390#, 16#8395#, 16#839F#, 16#039A#, 16#838B#, 16#038E#, 16#0384#, 16#8381#,
        16#0280#, 16#8285#, 16#828F#, 16#028A#, 16#829B#, 16#029E#, 16#0294#, 16#8291#,
        16#82B3#, 16#02B6#, 16#02BC#, 16#82B9#, 16#02A8#, 16#82AD#, 16#82A7#, 16#02A2#,
        16#82E3#, 16#02E6#, 16#02EC#, 16#82E9#, 16#02F8#, 16#82FD#, 16#82F7#, 16#02F2#,
        16#02D0#, 16#82D5#, 16#82DF#, 16#02DA#, 16#82CB#, 16#02CE#, 16#02C4#, 16#82C1#,
        16#8243#, 16#0246#, 16#024C#, 16#8249#, 16#0258#, 16#825D#, 16#8257#, 16#0252#,
        16#0270#, 16#8275#, 16#827F#, 16#027A#, 16#826B#, 16#026E#, 16#0264#, 16#8261#,
        16#0220#, 16#8225#, 16#822F#, 16#022A#, 16#823B#, 16#023E#, 16#0234#, 16#8231#,
        16#8213#, 16#0216#, 16#021C#, 16#8219#, 16#0208#, 16#820D#, 16#8207#, 16#0202#);

end CRC16;
